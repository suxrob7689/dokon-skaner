<!DOCTYPE html>
<html lang="uz">
<head>
Â  Â  <meta charset="UTF-8">
Â  Â  <meta name="viewport" content="width=device-width, initial-scale=1.0">
Â  Â  <title>Do'kon Skaner - Savat</title>
Â  Â  <style>
Â  Â  Â  Â  * { margin: 0; padding: 0; box-sizing: border-box; }
Â  Â  Â  Â  body {
Â  Â  Â  Â  Â  Â  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
Â  Â  Â  Â  Â  Â  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
Â  Â  Â  Â  Â  Â  min-height: 100vh;
Â  Â  Â  Â  Â  Â  padding: 20px;
Â  Â  Â  Â  }
Â  Â  Â  Â  .container {
Â  Â  Â  Â  Â  Â  max-width: 500px;
Â  Â  Â  Â  Â  Â  margin: 0 auto;
Â  Â  Â  Â  Â  Â  background: white;
Â  Â  Â  Â  Â  Â  border-radius: 20px;
Â  Â  Â  Â  Â  Â  box-shadow: 0 20px 60px rgba(0,0,0,0.3);
Â  Â  Â  Â  Â  Â  overflow: hidden;
Â  Â  Â  Â  }
Â  Â  Â  Â  .header {
Â  Â  Â  Â  Â  Â  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  Â  Â  padding: 30px 20px;
Â  Â  Â  Â  Â  Â  text-align: center;
Â  Â  Â  Â  }
Â  Â  Â  Â  .header h1 { font-size: 28px; margin-bottom: 5px; }
Â  Â  Â  Â  .header p { opacity: 0.9; font-size: 14px; }
Â  Â  Â  Â  .content { padding: 30px 20px; }
Â  Â  Â  Â  .scanner-section { margin-bottom: 25px; }
Â  Â  Â  Â  #reader {
Â  Â  Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  Â  Â  border-radius: 15px;
Â  Â  Â  Â  Â  Â  overflow: hidden;
Â  Â  Â  Â  Â  Â  display: none;
Â  Â  Â  Â  Â  Â  box-shadow: 0 4px 6px rgba(0,0,0,0.1);
Â  Â  Â  Â  }
Â  Â  Â  Â  #reader.show { display: block; }
Â  Â  Â  Â  .btn {
Â  Â  Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  Â  Â  padding: 15px;
Â  Â  Â  Â  Â  Â  border: none;
Â  Â  Â  Â  Â  Â  border-radius: 10px;
Â  Â  Â  Â  Â  Â  font-size: 16px;
Â  Â  Â  Â  Â  Â  font-weight: 600;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  Â  Â  transition: all 0.3s;
Â  Â  Â  Â  Â  Â  margin-bottom: 10px;
Â  Â  Â  Â  }
Â  Â  Â  Â  .btn:disabled {
Â  Â  Â  Â  Â  Â  opacity: 0.5;
Â  Â  Â  Â  Â  Â  cursor: not-allowed;
Â  Â  Â  Â  }
Â  Â  Â  Â  .btn-primary {
Â  Â  Â  Â  Â  Â  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  }
Â  Â  Â  Â  .btn-success {
Â  Â  Â  Â  Â  Â  background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  }
Â  Â  Â  Â  .btn-danger {
Â  Â  Â  Â  Â  Â  background: linear-gradient(135deg, #eb3349 0%, #f45c43 100%);
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  }
Â  Â  Â  Â  .btn-warning {
Â  Â  Â  Â  Â  Â  background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  Â  Â  font-size: 18px;
Â  Â  Â  Â  }
Â  Â  Â  Â  .form-group { margin-bottom: 20px; }
Â  Â  Â  Â  .form-group label {
Â  Â  Â  Â  Â  Â  display: block;
Â  Â  Â  Â  Â  Â  margin-bottom: 8px;
Â  Â  Â  Â  Â  Â  color: #333;
Â  Â  Â  Â  Â  Â  font-weight: 600;
Â  Â  Â  Â  Â  Â  font-size: 14px;
Â  Â  Â  Â  }
Â  Â  Â  Â  .form-group input {
Â  Â  Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  Â  Â  padding: 12px 15px;
Â  Â  Â  Â  Â  Â  border: 2px solid #e0e0e0;
Â  Â  Â  Â  Â  Â  border-radius: 10px;
Â  Â  Â  Â  Â  Â  font-size: 16px;
Â  Â  Â  Â  Â  Â  transition: all 0.3s;
Â  Â  Â  Â  }
Â  Â  Â  Â  .form-group input:focus {
Â  Â  Â  Â  Â  Â  outline: none;
Â  Â  Â  Â  Â  Â  border-color: #667eea;
Â  Â  Â  Â  Â  Â  box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
Â  Â  Â  Â  }
Â  Â  Â  Â  .cart-section {
Â  Â  Â  Â  Â  Â  background: #f8f9fa;
Â  Â  Â  Â  Â  Â  border-radius: 15px;
Â  Â  Â  Â  Â  Â  padding: 20px;
Â  Â  Â  Â  Â  Â  margin-bottom: 25px;
Â  Â  Â  Â  Â  Â  display: none;
Â  Â  Â  Â  }
Â  Â  Â  Â  .cart-section.show { display: block; }
Â  Â  Â  Â  .cart-header {
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  justify-content: space-between;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  margin-bottom: 15px;
Â  Â  Â  Â  Â  Â  padding-bottom: 15px;
Â  Â  Â  Â  Â  Â  border-bottom: 2px solid #e0e0e0;
Â  Â  Â  Â  }
Â  Â  Â  Â  .cart-header h3 {
Â  Â  Â  Â  Â  Â  font-size: 18px;
Â  Â  Â  Â  Â  Â  color: #333;
Â  Â  Â  Â  }
Â  Â  Â  Â  .cart-count {
Â  Â  Â  Â  Â  Â  background: #667eea;
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  Â  Â  padding: 5px 12px;
Â  Â  Â  Â  Â  Â  border-radius: 20px;
Â  Â  Â  Â  Â  Â  font-size: 14px;
Â  Â  Â  Â  Â  Â  font-weight: 600;
Â  Â  Â  Â  }
Â  Â  Â  Â  .cart-item {
Â  Â  Â  Â  Â  Â  background: white;
Â  Â  Â  Â  Â  Â  border-radius: 10px;
Â  Â  Â  Â  Â  Â  padding: 15px;
Â  Â  Â  Â  Â  Â  margin-bottom: 10px;
Â  Â  Â  Â  Â  Â  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
Â  Â  Â  Â  }
Â  Â  Â  Â  .cart-item-header {
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  justify-content: space-between;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  margin-bottom: 10px;
Â  Â  Â  Â  }
Â  Â  Â  Â  .cart-item-name {
Â  Â  Â  Â  Â  Â  font-weight: 600;
Â  Â  Â  Â  Â  Â  color: #333;
Â  Â  Â  Â  Â  Â  font-size: 16px;
Â  Â  Â  Â  }
Â  Â  Â  Â  .cart-item-remove {
Â  Â  Â  Â  Â  Â  background: #ef4444;
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  Â  Â  border: none;
Â  Â  Â  Â  Â  Â  padding: 6px 12px;
Â  Â  Â  Â  Â  Â  border-radius: 8px;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  Â  Â  font-size: 12px;
Â  Â  Â  Â  Â  Â  font-weight: 600;
Â  Â  Â  Â  }
Â  Â  Â  Â  .cart-item-barcode {
Â  Â  Â  Â  Â  Â  font-size: 12px;
Â  Â  Â  Â  Â  Â  color: #666;
Â  Â  Â  Â  Â  Â  margin-bottom: 8px;
Â  Â  Â  Â  }
Â  Â  Â  Â  .cart-item-details {
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  justify-content: space-between;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  padding-top: 10px;
Â  Â  Â  Â  Â  Â  border-top: 1px solid #e0e0e0;
Â  Â  Â  Â  }
Â  Â  Â  Â  .quantity-controls {
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  gap: 10px;
Â  Â  Â  Â  }
Â  Â  Â  Â  .quantity-btn {
Â  Â  Â  Â  Â  Â  background: #667eea;
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  Â  Â  border: none;
Â  Â  Â  Â  Â  Â  width: 32px;
Â  Â  Â  Â  Â  Â  height: 32px;
Â  Â  Â  Â  Â  Â  border-radius: 6px;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  Â  Â  font-size: 18px;
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  justify-content: center;
Â  Â  Â  Â  Â  Â  font-weight: 600;
Â  Â  Â  Â  }
Â  Â  Â  Â  .quantity-display {
Â  Â  Â  Â  Â  Â  font-weight: 600;
Â  Â  Â  Â  Â  Â  min-width: 40px;
Â  Â  Â  Â  Â  Â  text-align: center;
Â  Â  Â  Â  Â  Â  font-size: 16px;
Â  Â  Â  Â  }
Â  Â  Â  Â  .cart-total {
Â  Â  Â  Â  Â  Â  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  Â  Â  padding: 15px;
Â  Â  Â  Â  Â  Â  border-radius: 10px;
Â  Â  Â  Â  Â  Â  margin-top: 15px;
Â  Â  Â  Â  Â  Â  text-align: center;
Â  Â  Â  Â  Â  Â  font-size: 20px;
Â  Â  Â  Â  Â  Â  font-weight: 600;
Â  Â  Â  Â  }
Â  Â  Â  Â  .empty-cart {
Â  Â  Â  Â  Â  Â  text-align: center;
Â  Â  Â  Â  Â  Â  padding: 40px 20px;
Â  Â  Â  Â  Â  Â  color: #666;
Â  Â  Â  Â  }
Â  Â  Â  Â  .empty-cart-icon {
Â  Â  Â  Â  Â  Â  font-size: 48px;
Â  Â  Â  Â  Â  Â  margin-bottom: 15px;
Â  Â  Â  Â  }
Â  Â  Â  Â  .alert {
Â  Â  Â  Â  Â  Â  padding: 15px;
Â  Â  Â  Â  Â  Â  border-radius: 10px;
Â  Â  Â  Â  Â  Â  margin-bottom: 20px;
Â  Â  Â  Â  Â  Â  display: none;
Â  Â  Â  Â  }
Â  Â  Â  Â  .alert.show {
Â  Â  Â  Â  Â  Â  display: block;
Â  Â  Â  Â  Â  Â  animation: slideIn 0.3s ease;
Â  Â  Â  Â  }
Â  Â  Â  Â  .alert-success {
Â  Â  Â  Â  Â  Â  background: #d1fae5;
a
Â  Â  Â  Â  Â  Â  color: #065f46;
Â  Â  Â  Â  Â  Â  border: 2px solid #10b981;
Â  Â  Â  Â  }
Â  Â  Â  Â  .alert-error {
Â  Â  Â  Â  Â  Â  background: #fee2e2;
Â  Â  Â  Â  Â  Â  color: #991b1b;
Â  Â  Â  Â  Â  Â  border: 2px solid #ef4444;
Â  Â  Â  Â  }
Â  Â  Â  Â  .alert-info {
Â  Â  Â  Â  Â  Â  background: #dbeafe;
Â  Â  Â  Â  Â  Â  color: #1e40af;
Â  Â  Â  Â  Â  Â  border: 2px solid #3b82f6;
Â  Â  Â  Â  }
Â  Â  Â  Â  @keyframes slideIn {
Â  Â  Â  Â  Â  Â  from { opacity: 0; transform: translateY(-10px); }
Â  Â  Â  Â  Â  Â  to { opacity: 1; transform: translateY(0); }
Â  Â  Â  Â  }
Â  Â  Â  Â  .loading {
Â  Â  Â  Â  Â  Â  display: none;
Â  Â  Â  Â  Â  Â  text-align: center;
Â  Â  Â  Â  Â  Â  padding: 20px;
Â  Â  Â  Â  }
Â  Â  Â  Â  .loading.show { display: block; }
Â  Â  Â  Â  .spinner {
Â  Â  Â  Â  Â  Â  border: 4px solid #f3f3f3;
L
Â  Â  Â  Â  Â  Â  border-top: 4px solid #667eea;
Â  Â  Â  Â  Â  Â  border-radius: 50%;
Â  Â  Â  Â  Â  Â  width: 40px;
Â  Â  Â  Â  Â  Â  height: 40px;
Â  Â  Â  Â  Â  Â  animation: spin 1s linear infinite;
Â  Â  Â  Â  Â  Â  margin: 0 auto;
Â  Â  Â  Â  }
Â  Â  Â  Â  @keyframes spin {
Â  Â  Â  Â  Â  Â  0% { transform: rotate(0deg); }
Â  Â  Â  Â  Â  Â  100% { transform: rotate(360deg); }
Â  Â  Â  Â  }
Â  Â  Â  Â  .info-badge {
Â  Â  Â  Â  Â  Â  display: inline-block;
D
Â  Â  Â  Â  Â  Â  background: #dbeafe;
Â  Â  Â  Â  Â  Â  color: #1e40af;
Â  Â  Â  Â  Â  Â  padding: 4px 10px;
Â  Â  Â  Â  Â  Â  border-radius: 12px;
Â  Â  Â  Â  Â  Â  font-size: 12px;
Â  Â  Â  Â  Â  Â  margin-left: 8px;
Â  Â  Â  Â  }
Â  Â  </style>
</head>
<body>
Â  Â  <div class="container">
Â  Â  Â  Â  <div class="header">
Â  Â  Â  Â  Â  Â  <h1>ğŸ›’ Do'kon Skaner</h1>
GA
Â  Â  Â  Â  Â  Â  <p>Tovarlarni skanerlang va buyurtma bering</p>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div class="content">
Â  Â  Â  Â  Â  Â  <div id="alert" class="alert"></div>

Â  Â  Â  Â  Â  Â  <div class="scanner-section">
Â  Â  Â  Â  Â  Â  Â  Â  <button id="scanBtn" class="btn btn-primary">ğŸ“· Tovar Skanerlash</button>
Â  Â  Â  Â  Â  Â  Â  Â  <div id="reader"></div>
Â  Â  Â  Â  Â  Â  Â  Â  <button id="stopBtn" class="btn btn-danger" style="display: none;">â¹ Kamerani O'chirish</button>
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <div class="form-group">
Â  Â  Â  Â  Â  Â  Â  Â  <label for="barcodeInput">ğŸ“¦ Yoki qo'lda kiriting:</label>
Â  Â  Â  Â  Â  Â  Â  Â  <input type="text" id="barcodeInput" placeholder="Shtrix-kodni kiriting..." autocomplete="off">
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <button id="addToCartManual" class="btn btn-success">â• Savatga Qo'shish</button>

Â  Â  Â  Â  Â  Â  <div class="cart-section" id="cartSection">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="cart-header">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h3>ğŸ›’ Savat</h3>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="cart-count" id="cartCount">0</span>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div id="cartItems">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="empty-cart">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="empty-cart-icon">ğŸ›’</div>
aS
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p>Savat bo'sh</p>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p style="font-size: 14px; margin-top: 5px;">Tovar skanerlang yoki qo'lda kiriting</p>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
sS
Â  Â  Â  Â  Â  Â  Â  Â  <div class="cart-total" id="cartTotal">Jami: 0 ta tovar</div>
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <div class="form-group">
Â  Â  Â  Â  Â  Â  Â  Â  <label for="customer">ğŸ‘¤ Mijoz ismi <span class="info-badge">Ixtiyoriy</span></label>
Â  Â  Â  Â  Â  Â  Â  Â  <input type="text" id="customer" placeholder="Kiriting yoki bo'sh qoldiring (No'malum)" value="">
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <div class="loading" id="loading">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="spinner"></div>
Â  Â  Â  Â  Â  Â  Â  Â  <p style="margin-top: 10px; color: #667eea;">Yuborilmoqda...</p>
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  S
Â  Â  Â  Â  <button id="checkoutBtn" class="btn btn-warning" style="display: none;">
Â  Â  Â  Â  Â  Â  Â  Â  âœ… Buyurtmani Tugatish
Â  Â  Â  Â  Â  Â  </button>
Â  Â  S
Â  Â  Â  Â  <button id="clearCartBtn" class="btn btn-danger" style="display: none;">
Â  Â  Â  Â  Â  Â  Â  Â  ğŸ—‘ï¸ Savatni Tozalash
Â  Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <script src="httpsS://unpkg.com/html5-qrcode@2.3.8/html5-qrcode.min.js"></script>
Â  Â  <script>
Â  Â  Â  Â  const WEBHOOK_URL = 'https://hook.eu2.make.com/epgyj96o1gdqkb1u5lmapugqrq1loa52';
Â  Â  Â  Â Â 
Â  Â  Â  Â  let cart = [];
Â  Â  Â  Â  let html5QrcodeScanner = null;
Â  Â  Â  Â  let isScanning = false;

Â  Â  Â  Â  const reader = document.getElementById('reader');
Â  Â  Â  Â  const scanBtn = document.getElementById('scanBtn');
Â  Â  Â  Â  const stopBtn = document.getElementById('stopBtn');
Â  Â  Â  Â  const barcodeInput = document.getElementById('barcodeInput');
Â  Â  Â  Â  const addToCartManual = document.getElementById('addToCartManual');
Â  Â  Â  Â  const customerInput = document.getElementById('customer');
Â  Â  Â  Â  const checkoutBtn = document.getElementById('checkoutBtn');
Â  Â  Â  Â  const clearCartBtn = document.getElementById('clearCartBtn');
Â  Â  Â  Â  const cartSection = document.getElementById('cartSection');
Â  Â  Â  Â  const cartItems = document.getElementById('cartItems');
Â  Â  Â  Â  const cartCount = document.getElementById('cartCount');
Â  Â  Â  Â  const cartTotal = document.getElementById('cartTotal');
Â  Â  Â  Â  const loading = document.getElementById('loading');
Â  Â  Â  Â  const alertBox = document.getElementById('alert');

Â  Â  Â  Â  cartSection.classList.add('show');

Â  Â  Â  Â  scanBtn.addEventListener('click', () => {
Â  Â  Â  Â  Â  Â  if (!isScanning) startScanner();
Â  Â  Â  Â  });

Â  Â  Â  Â  stopBtn.addEventListener('click', () => {
Â  Â  Â  Â  Â  Â  stopScanner();
Â  Â  Â  Â  });

Â  Â  Â  Â  addToCartManual.addEventListener('click', () => {
Â  Â  Â  Â  Â  Â  const barcode = barcodeInput.value.trim();
Â  Â  Â  Â  Â  Â  if (barcode) {
Â  Â  Â  Â  Â  Â  Â  Â  addToCart(barcode);
Â  Â  Â  Â  Â  Â  Â  Â  barcodeInput.value = '';
Â  Â  Â  Â  Â  Â  Â  Â  barcodeInput.focus();
Â  Â  Â  Dos
Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  showAlert('âŒ Shtrix-kod kiriting!', 'error');
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  });

Â  Â  Â  Â  barcodeInput.addEventListener('keypress', (e) => {
Â  Â  Â  Â  Â  Â  if (e.key === 'Enter') {
Â  Â  Â  Â  Â  Â  Â  Â  e.preventDefault();
Â  Â  Â  Â  Â  Â  Â  Â  addToCartManual.click();
aS
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  });

Â  Â  Â  Â  checkoutBtn.addEventListener('click', () => {
Â  Â  Â  Â  Â  Â  checkout();
Â  Â  Â  Â  });

Â  Â  Â  Â  clearCartBtn.addEventListener('click', () => {
Â  Â  Â  Â  Â  Â  if (confirm('Savatni tozalashni xohlaysizmi?')) {
Â  Â  Â  Â  Â  Â  Â  Â  cart = [];
Â  Â  Â  Â  Â  Â  Â  Â  updateCartDisplay();
Â  Â  Â  Â  Â  Â  Â  Â  showAlert('ğŸ—‘ï¸ Savat tozalandi', 'info');
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  });

Â  Â  Â  Â  function startScanner() {
Â  Â  Â  Â  Â  Â  reader.classList.add('show');
aS
Â  Â  Â  Â  Â  Â  scanBtn.style.display = 'none';
Â  Â  Â  Â  Â  Â  stopBtn.style.display = 'block';
Â  Â  Â  Â  Â  Â  isScanning = true;

Â  S
Â  Â  Â  Â  Â  Â  html5QrcodeScanner = new Html5Qrcode("reader");

Â  Â  Â  Â  Â  Â  const config = {
Â  Â  Â  Â  Â  Â  Â  Â  fps: 10,
Â  Â  Â  Â  Â  Â  Â  Â  qrbox: { width: 250, height: 250 },
aS
Â  Â  Â  Â  Â  Â  Â  Â  aspectRatio: 1.0,
Â  Â  Â  Â  Â  Â  Â  Â  formatsToSupport: [
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Html5QrcodeSupportedFormats.EAN_13,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Html5QrcodeSupportedFormats.EAN_8,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Html5QrcodeSupportedFormats.UPC_A,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Html5QrcodeSupportedFormats.UPC_E,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Html5QrcodeSupportedFormats.CODE_128,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Html5QrcodeSupportedFormats.CODE_39
Â  Â  Â  Â  Â  Â  Â  Â  ]
Â  Â  Â  Â  Â  Â  };

Â  Â  Â  Â  Â  Â  html5QrcodeScanner.start(
Â  Â  Â  Â  Â  Â  Â  Â  { facingMode: "environment" },
Â  Â  Â  Â  Â  Â  Â  Â  config,
Â  Â  Â  Â  Â  Â  Â  Â  (decodedText) => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  console.log(`Skanerlandi: ${decodedText}`);
aS
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  addToCart(decodedText);
Â  Â  Â  Â  Â  Â  Â  Â  Â  S
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  playBeep();
SA
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  stopScanner();
Â  Â  Â  Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  Â  Â  Â  (errorMessage) => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Ignore
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  ).catch((err) => {
SA
Â  Â  Â  Â  Â  Â  Â  Â  console.error("Skaner xatosi:", err);
Â  Â  Â  Â  Â  Â  Â  Â  showAlert('âŒ Kamera ochilmadi! Ruxsat bering.', 'error');
Â  Â  Â  Â  Â  Â  Â  Â  stopScanner();
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  }

Â  Â  Â  Â  function stopScanner() {
Â  Â  Â  Â  Â  Â  if (isScanning && html5QrcodeScanner) {
Â  Â  Â  Â  Â  Â  Â  Â  html5QrcodeScanner.stop().then(() => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  html5QrcodeScanner.clear();
Â  Â  Â  Â  Â  Â  Â  S
Â  }).catch(() => {}).finally(() => {
Â  Â  Â  Â  Â  S
Â  Â  Â  Â  Â  Â  Â  Â  Â  reader.classList.remove('show');
aS
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  scanBtn.style.display = 'block';
S
Â  Â  Â  Â  Â  S
Â  Â  Â  Â  Â  Â  Â  Â  stopBtn.style.display = 'none';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  isScanning = false;
Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  GA
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  function addToCart(barcode) {
Â  Â  Â  Â  Â  Â  const existingItem = cart.find(item => item.barcode === barcode);
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  if (existingItem) {
Â  Â  Â  Â  Â  Â  Â  Â  existingItem.quantity++;
Â  Â  Â  Â  Â  Â  Â  Â  showAlert(`â• Miqdori oshirildi!`, 'success');
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  cart.push({
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  barcode: barcode,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  quantity: 1
Â  Â  Â  Â  Â  Â  Â  Â  });
aS
Â  Â  Â  Â  Â  Â  Â  Â  showAlert(`âœ… Savatga qo'shildi: ${barcode}`, 'success');
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  updateCartDisplay();
Â  Â  Â  Â  }

Â  Â  Â  Â  function removeFromCart(index) {
Â  Â  Â  Â  Â  Â  const item = cart[index];
Â  Â  Â  Â  Â  Â  cart.splice(index, 1);
Â  Â  Â  Â  Â  Â  showAlert(`ğŸ—‘ï¸ O'chirildi`, 'info');
Â  Â  Â  Â  Â  Â  updateCartDisplay();
Â  Â  Â  Â  }

Â  Â  Â  Â  function updateQuantity(index, delta) {
Â  Â  Â  Â  Â  Â  cart[index].quantity += delta;
aS
Â  Â  Â  Â  Â  Â  if (cart[index].quantity <= 0) {
Â  Â  Â  Â  Â  Â  Â  Â  removeFromCart(index);
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  updateCartDisplay();
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  function updateCartDisplay() {
Â  Â  Â  Â  Â  Â  if (cart.length === 0) {
Â  Â  Â  Â  Â  Â  Â  Â  cartItems.innerHTML = `
Â  Â  S
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="empty-cart">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="empty-cart-icon">ğŸ›’</div>
Â  Â  Â  Â  Â  Â  Â  Â  SA
Â  Â  Â  Â  Â  Â  Â  Â  <p>Savat bo'sh</p>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p style="font-size: 14px; margin-top: 5px;">Tovar skanerlang yoki qo'lda kiriting</p>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  `;
Â  S
Â  Â  Â  Â  Â  Â  Â  Â  checkoutBtn.style.display = 'none';
SA
Â  Â  Â  Â  Â  Â  Â  Â  clearCartBtn.style.display = 'none';
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  let html = '';
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  cart.forEach((item, index) => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  html += `
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="cart-item">
aS
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="cart-item-header">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="cart-item-name">Tovar ${item.barcode.slice(-4)}</div>
s
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="cart-item-remove" onclick="removeFromCart(${index})">âœ•</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="cart-item-barcode">Barcode: ${item.barcode}</div>
aS
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="cart-item-details">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="quantity-controls">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="quantity-btn" onclick="updateQuantity(${index}, -1)">âˆ’</button>
Â  Â  Â  Â  Â  aS
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="quantity-display">${item.quantity}</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="quantity-btn" onclick="updateQuantity(${index}, 1)">+</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  aS
Â  `;
Â  Â  Â  Â  S
Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  cartItems.innerHTML = html;
Â  Â  Â  Â  Â  Â  Â  Â  checkoutBtn.style.display = 'block';
Â  Â  Â  Â  Â  Â  Â  Â  clearCartBtn.style.display = 'block';
Â  aS
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  cartCount.textContent = cart.length;
aS
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
Â  Â  Â  Â  Â  Â  cartTotal.textContent = `Jami: ${totalItems} ta tovar`;
Â  Â  Â  Â  }

Â  Â  Â  Â  async function checkout() {
Â  Â  Â  Â  Â  Â  if (cart.length === 0) {
aS
Â  Â  Â  Â  Â  Â  Â  Â  showAlert('âŒ Savat bo\'sh!', 'error');
Â  Â  Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  const customer = customerInput.value.trim() || 'No\'malum';
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  loading.classList.add('show');
Â  Â  Â  Â  Â  Â  checkoutBtn.disabled = true;

Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  const response = await fetch(WEBHOOK_URL, {
aS
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  method: 'POST',
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  headers: { 'Content-Type': 'application/json' },
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  body: JSON.stringify({
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  customer: customer,
aS
Â  Â  Â  Â  Â  S
Â  Â  Â  Â  Â  Â  Â  Â  items: cart,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  timestamp: new Date().toISOString()
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  })
Â  Â  Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  Â  Â  Â  if (response.ok) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  showAlert('âœ… Buyurtma muvaffaqiyatli yuborildi!', 'success');
Â  Â  Â  aS
Â  Â  Â  Â  Â  Â  Â  Â  cart = [];
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  customerInput.value = '';
aS
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  updateCartDisplay();
Â  Â  Â  Â  Â  Â  Â  Â  } else {
Â  aS
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  showAlert('âŒ Xatolik yuz berdi! Qayta urinib ko\'ring.', 'error');
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  } catch (error) {
Â  Â  Â  Â  Â  Â  Â  Â  console.error('Error:', error);
Â  Â  Â  Â  Â  Â  Â  Â  showAlert('âš ï¸ Tarmoq xatosi! Internetni tekshiring.', 'error');
Â  Â  Â  Â  Â  Â  } finally {
Â  aS
Â  Â  Â  Â  Â  Â  Â  Â  loading.classList.remove('show');
Â  Â  Â  Â  Â  Â  Â  Â  checkoutBtn.disabled = false;
Â  Â  Â  Â  Â  Â  }
Â  aS
Â  Â  Â  Â  }

Â  Â  Â  Â  function playBeep() {
Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  const audioContext = new (window.AudioContext || window.webkitAudioContext)();
aS
Â  Â  Â  Â  Â  Â  Â  Â  const oscillator = audioContext.createOscillator();
Â  Â  Â  Â  Â  Â  Â  Â  const gainNode = audioContext.createGain();
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  aS
Â  Â  Â  Â  Â  Â  Â  Â  oscillator.connect(gainNode);
aS
Â  Â  Â  Â  Â  Â  Â  Â  gainNode.connect(audioContext.destination);
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  aS
Â  Â  Â  Â  Â  Â  Â  Â  oscillator.frequency.value = 800;
Â  Â  Â  Â  Â  Â  Â  Â  oscillator.type = 'sine';
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
aS
Â  Â  Â  Â  Â  Â  Â  Â  gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.1);
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  oscillator.start(audioContext.currentTime);
Â  Â  Â  Â  Â  Â  Â  Â  oscillator.stop(audioContext.currentTime + 0.1);
Â  Â  Â  Â  Â  Â  } catch (e) {
Â  Â  Â  Â  Â  Â  Â  Â  console.log('Ovoz chiqmadi');
aS
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  function showAlert(message, type) {
Â  Â  Â  Â  Â  Â  alertBox.textContent = message;
Â  Â  Â  Â  Â  Â  alertBox.className = `alert alert-${type} show`;
Â  Â  Â  Â  Â  Â  setTimeout(() => { alertBox.classList.remove('show'); }, 4000);
aS
Â  Â  Â  Â  }

Â  Â  Â  Â  window.addEventListener('beforeunload', () => {
Â  Â  aS
Â  Â  Â  Â  Â  Â  if (isScanning) stopScanner();
Â  Â  Â  Â  });

Â  Â  Â  Â  window.removeFromCart = removeFromCart;
Â  Â  Â  Â  window.updateQuantity = updateQuantity;
Â  Â  </script>
</body>
</html>
